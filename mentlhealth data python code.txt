# data_processing.py
# This script loads the mental health dataset, performs initial checks,
# and stores it in a SQLite database for further processing.

import pandas as pd
from sqlalchemy import create_engine
from pathlib import Path

# Step 1: Load the dataset
file_path = "data/Mental_Health_Lifestyle_Dataset.csv"
df = pd.read_csv(file_path)

print("CSV loaded successfully. Here's a preview:")
print(df.head())

# Step 2: Prepare SQLite database folder
db_folder = Path("data")
db_folder.mkdir(parents=True, exist_ok=True)  # create folder if it doesn't exist
db_path = db_folder / "mental_health.db"

# Step 3: Create SQLite connection
engine = create_engine(f"sqlite:///{db_path}")

# Step 4: Save DataFrame to SQLite
df.to_sql('mental_health_data', con=engine, index=False, if_exists='replace')
print("Data successfully saved to SQLite database.")

# Step 5: Quick check to ensure data is stored
result = pd.read_sql('SELECT * FROM mental_health_data LIMIT 5;', con=engine)
print("Preview from SQLite database:")
print(result)
